package org.example;

import java.util.Scanner;


/**
 * For user-interface. Kaller metoder fra Diary for å legge til eller vise innlegg.
 */

public class Main {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        Diary diary = new Diary();
        boolean isProgramRunning = true;

        while (isProgramRunning) {
            System.out.println("\n--- Min Dagbok ---");
            System.out.println("1. Legg til nytt innlegg");
            System.out.println("2. Vis alle innlegg");
            System.out.println("3. Slett et innlegg");
            System.out.println("4. Søk etter et innlegg");
            System.out.println("5. Avslutt");
            System.out.print("Velg et alternativ: ");


            //Sjekker at brukeren har skrevet noe.
            String choiceStr = scanner.nextLine().trim();
            if (choiceStr.isEmpty()) {
                System.out.println("Skriv et tall fra 1-5!");
                continue;
            }

            int choice;
            try {
                choice = Integer.parseInt(choiceStr);
            } catch (NumberFormatException e) {
                System.out.println("Skriv et tall (1-5).");
                continue;
            }

             /**
             * Case 1-5 kjøres basert på bruker input.
             * Forventet funskon(er) for hver case er vist ovenfor.
             */

            switch (choice) {
                case 1 -> {
                    String title;
                    do {
                        System.out.print("Tittel: ");
                        title = scanner.nextLine().trim();
                        if (title.isEmpty()) {
                            System.out.println("Helst lag en tittel");
                        }
                    } while (title.isEmpty());

                    String author;
                    do {
                        System.out.print("Forfatter: ");
                        author = scanner.nextLine().trim();
                        if (author.isEmpty()) {
                            System.out.println("Helst lag en author");
                        }
                    } while (author.isEmpty());

                    String entry;
                    do {
                        System.out.print("Innhold: ");
                        entry = scanner.nextLine().trim();
                        if (entry.isEmpty()) {
                            System.out.println("Helst lag en entry.");
                        }
                    } while (entry.isEmpty());

                    diary.addEntry(title, author, entry);
                    System.out.println("Innlegg lagt til!");
                }
                case 2 -> {
                    diary.showAllEntries();
                    System.out.println("Antall innlegg: " + diary.size());
                }

                case 3 -> {
                    diary.showAllEntries();
                    System.out.println("Skriv nummer til innlegg som skal slettes, (1-" + diary.size() + "):");
                    String numStr = scanner.nextLine();
                    try {
                        int num = Integer.parseInt(numStr);
                        boolean deletedSuccessfully = diary.deleteEntry(num - 1);
                        if (deletedSuccessfully) {
                            System.out.println("Innlegg slettet!");
                        } else {
                            System.out.println("Skriv inn et gyldig nummer");
                        }
                    } catch (NumberFormatException ex) {
                        System.out.println("Skriv inn et gyldig nummer");
                    }
                }
                case 4 -> { //for å søke
                    System.out.println("Søk etter innlegg: ");
                    String searchWord = scanner.nextLine();
                    diary.search(searchWord);
                }
                case 5 -> {
                    System.out.println("Er du sikker på at du vil avslutte? (j/n)");
                    String confirm = scanner.nextLine();

                    if (confirm.equals("j")) { //sjekker at brukeren har skrevet j, eller noe annet.
                        scanner.close();
                        isProgramRunning = false;
                    }
                }

                default -> System.out.println("Ugyldig valg. Velg et tall mellom 1-5"); //hvis brukerne ikke skriver noe
            }
        }
    }
}

